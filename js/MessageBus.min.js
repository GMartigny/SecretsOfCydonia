
function MessageBus(){this.listener={};this.watcher={}}MessageBus.prototype={listen:function(a,b){if(!this.listener[a]){this.listener[a]=[]}this.listener[a].push(b);return this},watch:function(a,b){if(!this.watcher[a]){this.watcher[a]=b}return this},notifyAll:function(a,b){if(this.listener[a]){this.listener[a].forEach(function(c){c(b)})}},notifyAllImmediatly:function(a,b){if(this.watcher[a]){return this.watcher[a](b)}}};MessageBus.instance=false;MessageBus.getInstance=function(){if(!MessageBus.instance){MessageBus.instance=new MessageBus()}return MessageBus.instance};MessageBus.MSG_TYPES={keydown:1,keyup:2,isBlocked:3,characterHasMoved:4};